{
  "$ref": "#/definitions/FlowConfig",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "DynamicElement": {
      "additionalProperties": false,
      "properties": {
        "format": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "sayAs": {
          "$ref": "#/definitions/SayAs"
        },
        "type": {
          "const": "dynamic",
          "type": "string"
        }
      },
      "required": [
        "type",
        "sayAs",
        "name"
      ],
      "type": "object"
    },
    "EndCallStep": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string"
        },
        "outs": {
          "additionalProperties": {
            "type": "string"
          },
          "type": "object"
        },
        "type": {
          "const": "endCall",
          "type": "string"
        }
      },
      "required": [
        "name",
        "type"
      ],
      "type": "object"
    },
    "FlowConfig": {
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "initialStepName": {
          "type": "string"
        },
        "links": {
          "additionalProperties": {
            "type": "string"
          },
          "type": "object"
        },
        "name": {
          "type": "string"
        },
        "steps": {
          "items": {
            "$ref": "#/definitions/FlowStep"
          },
          "type": "array"
        }
      },
      "required": [
        "id",
        "name",
        "initialStepName",
        "steps",
        "links"
      ],
      "type": "object"
    },
    "FlowStep": {
      "anyOf": [
        {
          "$ref": "#/definitions/MakeCallStep"
        },
        {
          "$ref": "#/definitions/GatherIntentStep"
        },
        {
          "$ref": "#/definitions/PlayMessageStep"
        },
        {
          "$ref": "#/definitions/EndCallStep"
        }
      ]
    },
    "GatherIntentStep": {
      "additionalProperties": false,
      "properties": {
        "additionalInstructions": {
          "type": "string"
        },
        "agentPrompt": {
          "$ref": "#/definitions/Message"
        },
        "entityExtractionInstructions": {
          "type": "string"
        },
        "intents": {
          "items": {
            "$ref": "#/definitions/Intent"
          },
          "type": "array"
        },
        "name": {
          "type": "string"
        },
        "outs": {
          "additionalProperties": {
            "type": "string"
          },
          "type": "object"
        },
        "preamble": {
          "type": "string"
        },
        "type": {
          "const": "gatherIntent",
          "type": "string"
        }
      },
      "required": [
        "agentPrompt",
        "intents",
        "name",
        "preamble",
        "type"
      ],
      "type": "object"
    },
    "Intent": {
      "additionalProperties": false,
      "properties": {
        "criteria": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      },
      "required": [
        "name",
        "criteria"
      ],
      "type": "object"
    },
    "MakeCallStep": {
      "additionalProperties": false,
      "properties": {
        "from": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "outs": {
          "additionalProperties": {
            "type": "string"
          },
          "type": "object"
        },
        "timeout": {
          "type": "number"
        },
        "to": {
          "type": "string"
        },
        "type": {
          "const": "makeCall",
          "type": "string"
        }
      },
      "required": [
        "from",
        "name",
        "timeout",
        "to",
        "type"
      ],
      "type": "object"
    },
    "Message": {
      "additionalProperties": false,
      "properties": {
        "elements": {
          "items": {
            "$ref": "#/definitions/MessageElement"
          },
          "type": "array"
        }
      },
      "required": [
        "elements"
      ],
      "type": "object"
    },
    "MessageElement": {
      "anyOf": [
        {
          "$ref": "#/definitions/DynamicElement"
        },
        {
          "$ref": "#/definitions/TTSElement"
        }
      ]
    },
    "PlayMessageStep": {
      "additionalProperties": false,
      "properties": {
        "message": {
          "$ref": "#/definitions/Message"
        },
        "name": {
          "type": "string"
        },
        "outs": {
          "additionalProperties": {
            "type": "string"
          },
          "type": "object"
        },
        "type": {
          "const": "playMessage",
          "type": "string"
        }
      },
      "required": [
        "message",
        "name",
        "type"
      ],
      "type": "object"
    },
    "SayAs": {
      "enum": [
        "date",
        "time",
        "number",
        "text",
        "digits"
      ],
      "type": "string"
    },
    "TTSElement": {
      "additionalProperties": false,
      "properties": {
        "text": {
          "type": "string"
        },
        "type": {
          "const": "tts",
          "type": "string"
        }
      },
      "required": [
        "type",
        "text"
      ],
      "type": "object"
    }
  }
}